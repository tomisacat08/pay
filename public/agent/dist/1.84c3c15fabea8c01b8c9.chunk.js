webpackJsonp([1],{233:function(e,t,n){"use strict";function a(e){c||(n(323),n(325))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(259),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,function(){return o[e]})}(r);var s=n(327),l=(n.n(s),n(4)),c=!1,d=a,m=Object(l.a)(i.a,s.render,s.staticRenderFns,!1,d,"data-v-a964bf80",null);m.options.__file="src\\views\\transaction\\ordinarydeal.vue",t.default=m.exports},239:function(e,t,n){e.exports=n.p+"33d7315a39c1294f6b06844e2f3b084d.png"},259:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(91),i=a(o),r=n(32),s=a(r),l=function(e,t,n,a){return t("Poptip",{props:{confirm:!0,title:"确定收到该会员的返款吗？",transfer:!0},on:{"on-ok":function(){s.default.post("Transaction/confirmRefund",{id:n.id}).then(function(t){n.loading=!1,1===t.data.code?(e.tableData.splice(a,1),e.$Message.success(t.data.msg)):e.$Message.error(t.data.msg)})}}},[t("Button",{style:{margin:"0 5px"},props:{type:"primary",placement:"top",loading:n.isDeleting}},"确认已返款")])},c=function(e,t,n,a){return t("Button",{props:{type:"info"},style:{margin:"0 5px"},on:{click:function(){if(n.return_money_img_id<=0)return e.$Message.error("无关联信息");s.default.get("Index/getImgUrlById",{params:{id:n.return_money_img_id}}).then(function(t){n.loading=!1,1===t.data.code?e.handleView(t.data.data):e.$Message.error(t.data.msg)})}}},"查看返款凭证")};t.default={name:"return_index",data:function(){return{uploadUrl:"",uploadHeader:{},content:"",isshow:!0,ids:[],columnsList:[{title:"订单序号",width:100,align:"center",key:"id"},{title:"商户编号",align:"center",key:"merchant_uid"},{title:"商户单号",align:"center",key:"merchant_order_sn"},{title:"收款金额",align:"center",key:"get_money"},{title:"应返款金额",align:"center",key:"return_money"},{title:"收款人",align:"center",key:"member_nickname"},{title:"收款账号",align:"center",key:"member_mobile"},{title:"返款时间",align:"center",key:"return_time"},{title:"操作",align:"center",key:"handle",width:280,handle:["help","check"]}],tableData:[],tableShow:{currentPage:1,pageSize:10,listCount:0},searchConf:{order_id:"",daterange:"",mobile:"",nickname:""},modalSetting:{show:!1,loading:!1,index:0},formItem:{excel:""},imgInfo:[],visible:!1,ruleValidate:{nickname:[{required:!0,message:"昵称不能为空",trigger:"blur"}],mobile:[{required:!0,message:"手机号码不能为空",trigger:"blur"}],agent_mobile:[{required:!0,message:"代理商手机号码不能为空",trigger:"blur"}]}}},created:function(){this.init(),this.getList()},methods:{timeChange:function(e){""===e[0]&&""===e[1]?this.searchConf.daterange="":this.searchConf.daterange=e},handleView:function(e){this.imgInfo=e,this.visible=!0},fileDownload:function(e,t){var n=new Blob([e],{type:"application/octet-stream"}),a=t||"普通收款员对账单模板.xlsx";if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,a);else{var o=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=o,i.setAttribute("download",a),void 0===i.download&&i.setAttribute("target","_blank"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(o)}},rowClassName:function(e,t){return 1===e.color_status?"ivu-table-stripe-even":2===e.color_status?"ivu-table-stripe-odd":void 0},handleAllMoney:function(){var e=this;s.default.post("Transaction/oneKeyConfirm",{ids:e.ids}).then(function(t){1===t.data.code?(e.getList(),e.$Message.success(t.data.msg)):e.$Message.error(t.data.msg)})},init:function(){var e=this,t=this;this.uploadUrl=i.default.baseUrl+"Transaction/importExcel",this.uploadHeader={agentToken:sessionStorage.getItem("agentToken")};var a=[];this.columnsList.forEach(function(o){o.handle&&(o.render=function(e,n){var o=t.tableData[n.index];return 1===o.color_status&&a.push(o.id),e("div",[l(t,e,o,n.index),c(t,e,o,n.index)])}),"return_pic"===o.key&&(o.render=function(a,o){var i=t.tableData[o.index];return a("div",[a("img",{attrs:{src:i.return_pic?i.return_pic:n(239)},style:{width:"80px",height:"80px",borderRadius:"2px",paddingTop:"5px"},on:{click:function(t){e.handleView(t.srcElement.currentSrc)}}})])})}),t.ids=a},alertAdd:function(){this.modalSetting.show=!0},downExcel:function(){var e=document.createElement("iframe");e.src="/excel/会员对账模板.xlsx",e.style.display="none",document.body.appendChild(e)},cancel:function(){this.modalSetting.show=!1},changePage:function(e){this.tableShow.currentPage=e,this.getList()},changeSize:function(e){this.tableShow.pageSize=e,this.getList()},search:function(){this.tableShow.currentPage=1,this.getList()},getList:function(){var e=this;s.default.get("Transaction/reconcile",{params:{page:e.tableShow.currentPage,size:e.tableShow.pageSize,order_id:e.searchConf.order_id,daterange:e.searchConf.daterange,mobile:e.searchConf.mobile,nickname:e.searchConf.nickname}}).then(function(t){var n=t.data;1===n.code?(e.tableData=n.data.list,e.tableShow.listCount=n.data.count):-14===n.code?(e.$store.commit("logout",e),e.$router.push({name:"login"})):e.$Message.error(n.msg)})},handleImgFormatError:function(e){this.$Notice.warning({title:"文件类型不合法",desc:e.name+"的文件类型不正确，请上传xls或者xlsx文件。"})},handleImgRemove:function(){this.formItem.excel=""},handleImgSuccess:function(e){1===e.code?(this.modalSetting.show=!1,this.getList(),this.$Message.success(e.msg)):this.$Message.error(e.msg)},handleImgMaxSize:function(e){this.$Notice.warning({title:"文件大小不合法",desc:e.name+"太大啦请上传小于5M的文件。"})},doCancel:function(e){e||(this.$refs.myForm.resetFields(),this.modalSetting.loading=!1,this.modalSetting.index=0)}}}},323:function(e,t,n){var a=n(324);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n(15).default;o("4f5560c5",a,!1,{})},324:function(e,t,n){t=e.exports=n(14)(!1),t.push([e.i,"\n.downFile[data-v-a964bf80] {\n  display: inline-block;\n  padding-left: 10px;\n  color: #57a3f3;\n  font-weight: 500;\n}\n.downFile[data-v-a964bf80]:hover {\n  cursor: pointer;\n  color: #2db7f5;\n}\n.ivu-modal-footer[data-v-a964bf80] {\n  border-top: 1px solid #fff !important;\n}\n",""])},325:function(e,t,n){var a=n(326);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n(15).default;o("393c7310",a,!1,{})},326:function(e,t,n){t=e.exports=n(14)(!1),t.push([e.i,"/*偶数行*/\n.ivu-table-stripe-even td {\n  color: #2d8cf0 !important;\n}\n/*奇数行*/\n.ivu-table-stripe-odd td {\n  color: #f00 !important;\n}\n",""])},327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Row",[n("Col",{attrs:{span:"24"}},[n("Card",{staticStyle:{"margin-bottom":"10px"}},[n("Form",{attrs:{inline:""}},[n("FormItem",{staticStyle:{"margin-bottom":"0"}},[n("Input",{attrs:{placeholder:"订单序号"},model:{value:e.searchConf.order_id,callback:function(t){e.$set(e.searchConf,"order_id",t)},expression:"searchConf.order_id"}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"0"}},[n("Input",{attrs:{placeholder:"收款员账号"},model:{value:e.searchConf.mobile,callback:function(t){e.$set(e.searchConf,"mobile",t)},expression:"searchConf.mobile"}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"0"}},[n("Input",{attrs:{placeholder:"收款员昵称"},model:{value:e.searchConf.nickname,callback:function(t){e.$set(e.searchConf,"nickname",t)},expression:"searchConf.nickname"}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"0"}},[n("Date-picker",{staticStyle:{width:"280px"},attrs:{type:"datetimerange",placeholder:"选择日期",format:"yyyy-MM-dd HH:mm:ss"},on:{"on-change":e.timeChange}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"0"}},[n("Button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询/刷新")])],1)],1)],1)],1)],1),e._v(" "),n("Row",[n("Col",{attrs:{span:"24"}},[n("Card",[n("p",{staticStyle:{height:"32px"},attrs:{slot:"title"},slot:"title"},[n("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"},on:{click:e.downExcel}},[e._v("下载Excel模板")]),e._v(" "),n("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"},on:{click:e.alertAdd}},[e._v("导入Excel文档")]),e._v(" "),n("Button",{attrs:{type:"info"},on:{click:e.handleAllMoney}},[e._v("一键确认已返款")])],1),e._v(" "),n("div",[n("Table",{attrs:{columns:e.columnsList,data:e.tableData,border:"","disabled-hover":"","row-class-name":e.rowClassName}})],1),e._v(" "),n("div",{staticClass:"margin-top-15",staticStyle:{"text-align":"center"}},[n("Page",{attrs:{total:e.tableShow.listCount,current:e.tableShow.currentPage,"page-size":e.tableShow.pageSize,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.changePage,"on-page-size-change":e.changeSize}})],1)])],1)],1),e._v(" "),n("Modal",{attrs:{width:"668",styles:{top:"30px"}},on:{"on-visible-change":e.doCancel},model:{value:e.modalSetting.show,callback:function(t){e.$set(e.modalSetting,"show",t)},expression:"modalSetting.show"}},[n("p",{staticStyle:{color:"#2d8cf0"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"md-information-circle"}}),e._v(" "),n("span",[e._v("导入模板信息")])],1),e._v(" "),n("Form",{ref:"myForm",staticClass:"formContent",attrs:{rules:e.ruleValidate,model:e.formItem,"label-width":100}},[n("FormItem",{attrs:{label:"导入文件",prop:"excel"}},[e.formItem.excel?n("div",{staticClass:"demo-upload-list"},[n("div",{staticStyle:{width:"528px","padding-left":"10px",border:"1px solid #eee","min-height":"300px"}},[e._v(" "+e._s(e.formItem.excel))]),e._v(" "),n("div",{staticClass:"demo-upload-list-cover"},[n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(t){e.handleImgRemove()}}})],1)]):e._e(),e._v(" "),e.formItem.excel?n("input",{directives:[{name:"model",rawName:"v-model",value:e.formItem.excel,expression:"formItem.excel"}],attrs:{type:"hidden",name:"excel"},domProps:{value:e.formItem.excel},on:{input:function(t){t.target.composing||e.$set(e.formItem,"excel",t.target.value)}}}):e._e(),e._v(" "),e.formItem.excel?e._e():n("Upload",{staticStyle:{display:"inline-block",width:"458px"},attrs:{type:"drag",name:"excel",multiple:!1,action:e.uploadUrl,headers:e.uploadHeader,format:["xlsx","xls"],"max-size":5120,"on-success":e.handleImgSuccess,"on-format-error":e.handleImgFormatError,"on-exceeded-size":e.handleImgMaxSize}},[n("div",{staticStyle:{margin:"0 auto",height:"158px","line-height":"158px"}},[n("Icon",{attrs:{type:"ios-paper",size:"20"}}),e._v("上传文件(可拖拽文件到此处)\n                    ")],1)])],1)],1),e._v(" "),n("div",{staticStyle:{display:"none","border-top":"1px solid #fff"},attrs:{slot:"footer"},slot:"footer"})],1),e._v(" "),n("Modal",{attrs:{title:"查看返款信息","class-name":"fl-image-modal"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("div",{staticClass:"status"},[n("img",{staticStyle:{width:"100%"},attrs:{src:e.imgInfo.imgUrl}}),e._v(" "),n("div",[e._v("类型:"+e._s(e.imgInfo.type_name))])])])],1)},o=[];a._withStripped=!0,t.render=a,t.staticRenderFns=o}});